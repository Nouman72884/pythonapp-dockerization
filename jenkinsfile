pipeline {
def commit_id
 stage('Preparation') {
   checkout scm
   sh "git rev-parse --short HEAD > .git/commit-id"
   commit_id = readFile('.git/commit-id').trim()
 }
  agent any
  stages {
    stage('Cloning Git') {
      steps {
        git 'https://github.com/Nouman72884/pythonapp-dockerization.git'
      }
    }
    stage('docker build/push') {
     docker.withRegistry('https://index.docker.io/v1/', 'dockerhub') {
       def app = docker.build("nouman72884/pythonapp:${commit_id}", '.').push()
     }
   }
  }
}
